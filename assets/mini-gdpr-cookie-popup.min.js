!function(){"use strict";class e{constructor(e){this.data=e,this.data.blkon="1"===e.blkon,this.data.always="1"===e.always,this._accepting=!1,this._overlayKeydown=null,this._popupKeydown=null}hasStoredDecision(e){if("undefined"!=typeof localStorage){const t=Date.parse(localStorage.getItem(e));if(t){const e=new Date;return Math.round((e-t)/1e3)<86400*parseInt(this.data.cd,10)}return!1}return document.cookie.split(";").some(t=>t.split("=")[0].trim().startsWith(e))}hasConsented(){return this.hasStoredDecision(this.data.cn)}hasRejected(){return this.hasStoredDecision(this.data.rcn)}showPopup(){const e=document.createElement("div");e.id="mgwcsCntr",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-label","Cookie consent"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-describedby","mgwcs-msg"),e.innerHTML=`<p id="mgwcs-msg">${this.data.msg}</p><div class="btn-box"><button class="reject" aria-label="Reject cookies">${this.data.rjt}</button><button class="more-info" aria-label="More information about cookies">${this.data.mre}</button><button class="accept" aria-label="Accept cookies">${this.data.ok}</button></div>`,e.querySelector("button.reject").addEventListener("click",()=>this.rejectConsent()),e.querySelector("button.accept").addEventListener("click",()=>this.consentToScripts()),e.querySelector("button.more-info").addEventListener("click",()=>this.showBlockedScripts()),Array.isArray(this.data.cls)&&(e.className=this.data.cls.join(" ")),document.body.appendChild(e),this._popupKeydown=t=>{if("Tab"!==t.key)return;const n=Array.from(e.querySelectorAll("button")),a=n[0],o=n[n.length-1];t.shiftKey?document.activeElement===a&&(t.preventDefault(),o.focus()):document.activeElement===o&&(t.preventDefault(),a.focus())},document.addEventListener("keydown",this._popupKeydown),e.querySelector("button.accept").focus()}consentToScripts(){if(this._accepting)return;const e=document.getElementById("mgwcsCntr");if(e){if(this._accepting=!0,this._popupKeydown&&(document.removeEventListener("keydown",this._popupKeydown),this._popupKeydown=null),"undefined"!=typeof localStorage)localStorage.setItem(this.data.cn,new Date);else{const e=new Date;e.setDate(e.getDate()+parseInt(this.data.cd,10)),document.cookie=`${this.data.cn}=true; expires=${e.toUTCString()}; Secure`}this.insertBlockedScripts(),this.loadGoogleAnalytics(),this.loadFacebookPixel(),this.loadMicrosoftClarity(),e.classList.add("mgw-fin"),setTimeout(()=>{e.remove(),this.showManagePreferencesLink()},500)}}rejectConsent(){const e=document.getElementById("mgwcsCntr");if(e&&this._popupKeydown&&(document.removeEventListener("keydown",this._popupKeydown),this._popupKeydown=null),"undefined"!=typeof localStorage)localStorage.setItem(this.data.rcn,new Date);else{const e=new Date;e.setDate(e.getDate()+parseInt(this.data.cd,10)),document.cookie=`${this.data.rcn}=true; expires=${e.toUTCString()}; Secure`}if(this.data.ajaxUrl&&this.data.rejectAction&&this.data.rejectNonce){const e=new URLSearchParams({action:this.data.rejectAction,nonce:this.data.rejectNonce});fetch(this.data.ajaxUrl,{method:"POST",body:e}).catch(()=>{})}e?(e.classList.add("mgw-fin"),setTimeout(()=>{e.remove(),this.showManagePreferencesLink()},500)):this.showManagePreferencesLink()}loadFacebookPixel(){if(!this.data.fbpxId)return;"function"==typeof fbq&&fbq("consent","grant");const e=document.createElement("script");e.src="https://connect.facebook.net/en_US/fbevents.js",e.async=!0,document.head.appendChild(e)}loadGoogleAnalytics(){if(!this.data.gaId)return;"function"==typeof gtag&&gtag("consent","update",{analytics_storage:"granted",ad_storage:"granted",ad_user_data:"granted",ad_personalization:"granted"});const e=document.createElement("script");e.src="https://www.googletagmanager.com/gtag/js?id="+this.data.gaId,e.async=!0,document.head.appendChild(e)}loadMicrosoftClarity(){if(!this.data.clarityId)return;const e=document.createElement("script");e.src="https://www.clarity.ms/tag/"+this.data.clarityId,e.async=!0,document.head.appendChild(e)}insertBlockedScripts(){if(this.data.blkon)for(const e in this.data.meta){if(!Object.prototype.hasOwnProperty.call(this.data.meta,e))continue;const t=this.data.meta[e];if(!t["can-defer"])continue;const n=document.createElement("script");if(n.setAttribute("src",t.src),document.head.appendChild(n),t.after){const e=document.createElement("script");e.appendChild(document.createTextNode(t.after)),document.head.appendChild(e)}}}showBlockedScripts(){const e=document.createElement("div");e.id="mgwcsOvly",e.className="mgw-ovl",e.setAttribute("role","dialog"),e.setAttribute("aria-modal","true"),e.setAttribute("aria-label","Cookie information"),e.addEventListener("click",t=>{t.target===e&&this.closeBlockedScripts()});const t=document.createElement("div");if(t.className="mgw-nfo",t.setAttribute("tabindex","-1"),e.appendChild(t),Object.keys(this.data.meta).length){const e=document.createElement("p");e.innerHTML=this.data.nfo1,this.data.nfo3&&(e.innerHTML+=`<br />${this.data.nfo3}`),t.appendChild(e);const n=document.createElement("ul");for(const e in this.data.meta){if(!Object.prototype.hasOwnProperty.call(this.data.meta,e))continue;const t=document.createElement("li");t.innerHTML=this.data.meta[e].description,n.appendChild(t)}const a=document.createElement("div");a.className="plglst",a.appendChild(n),t.appendChild(a)}else{const e=document.createElement("p");e.innerHTML=this.data.nfo2,t.appendChild(e)}const n=document.createElement("button");n.innerText="Close",n.setAttribute("aria-label","Close cookie information"),n.addEventListener("click",()=>this.closeBlockedScripts()),t.appendChild(n),this._overlayKeydown=e=>{if("Escape"!==e.key){if("Tab"===e.key){const n=Array.from(t.querySelectorAll('button, a[href], input, select, textarea, [tabindex]:not([tabindex="-1"])'));if(0===n.length)return void e.preventDefault();const a=n[0],o=n[n.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),o.focus()):document.activeElement===o&&(e.preventDefault(),a.focus())}}else this.closeBlockedScripts()},document.addEventListener("keydown",this._overlayKeydown),document.body.appendChild(e),n.focus()}closeBlockedScripts(){this._overlayKeydown&&(document.removeEventListener("keydown",this._overlayKeydown),this._overlayKeydown=null);const e=document.getElementById("mgwcsOvly");e&&e.remove();const t=document.querySelector("#mgwcsCntr button.more-info");t&&t.focus()}showManagePreferencesLink(){if(document.getElementById("mgwMngBtn"))return;const e=document.createElement("button");e.id="mgwMngBtn",e.textContent="ðŸª",e.setAttribute("aria-label","Manage cookie preferences"),e.setAttribute("title","Manage cookie preferences"),e.addEventListener("click",()=>this.changePreferences()),document.body.appendChild(e)}changePreferences(){const e=document.getElementById("mgwMngBtn");e&&e.remove(),this._accepting=!1,"undefined"!=typeof localStorage?(localStorage.removeItem(this.data.cn),localStorage.removeItem(this.data.rcn)):(document.cookie=`${this.data.cn}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`,document.cookie=`${this.data.rcn}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/`),this.showPopup()}init(){this.hasConsented()?(this.insertBlockedScripts(),this.loadGoogleAnalytics(),this.loadFacebookPixel(),this.loadMicrosoftClarity(),this.showManagePreferencesLink()):this.hasRejected()?this.showManagePreferencesLink():this.showPopup()}}document.addEventListener("DOMContentLoaded",()=>{if("undefined"!=typeof mgwcsData){const t=new e(mgwcsData);t.init(),window.mgwRejectScripts=()=>t.rejectConsent(),window.mgwShowCookiePreferences=()=>t.changePreferences()}})}();
//# sourceMappingURL=mini-gdpr-cookie-popup.min.js.map